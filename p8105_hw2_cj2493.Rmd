---
title: "p8105_hw2_cj2493"
author: "Courtney Johnson"
date: "September 28, 2018"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Problem 1

Read and clean the data, retain line, station name, station latitude/longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert entry variable to logical from character.

```{r, clean}
subway_data = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance_type, ada) %>%
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE)) %>%
  gather(key = route_served, value = route, route1:route11)
```

Describe the dataset:

This dataset contains information on the NYC subway. Each observation has a station name, the line it's on, the latitude and longitude of the station, the route(s) it serves, if you can enter the station, if there is vending, what type of entrance the station has, and if it is ADA compliant. There is a maximum of 11 routes served for each station. The dataset has `r nrow(subway_data)` rows and `r ncol(subway_data)` columns. These data could be more tidy by further cleaning the route_served variable. 


```{r, manipulation}
subway_data = distinct(subway_data, station_name, route, .keep_all = TRUE)
subway_no_vending = filter(subway_data, vending == "NO")
```

There are `r nrow(subway_data)` distinct stations. `r sum(as.numeric(subway_data$ada))` stations are ADA compliant. The proportion of station entrances/exits without vending that allow entrance is `r sum(as.numeric(subway_no_vending$entry))/nrow(subway_no_vending)`.


## Problem 2

```{r, mr_trash_wheel}
mr_trash_wheel_data = read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = "Mr. Trash Wheel", range = cell_cols("A:N")) %>%
  janitor::clean_names() %>%
  filter(!is.na(dumpster), !is.na(date)) %>%
  mutate(sports_balls = as.integer(sports_balls))
```

```{r, precipitation}
precip_17_data = read_xlsx("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet  = "2017 Precipitation", range = "A2:B14", col_names = TRUE) %>%
  janitor::clean_names() %>%
  mutate(year = 2017) %>%
  filter(!is.na(total))

precip_16_data = read_xlsx("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet  = "2016 Precipitation", range = "A2:B14", col_names = TRUE) %>%
  janitor::clean_names() %>%
  mutate(year = 2016) %>%
  filter(!is.na(total))

precip_data = left_join(precip_16_data, precip_17_data, by = "month") %>%
  mutate(month = month.name[month])
```



## Problem 3